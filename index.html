<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Trash Panda Dot Club</title>
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/favicon.png">
  <link rel="stylesheet" href="fonts/stylesheet.css">
  <style>
    body {
      margin: 0;
      background-color: #000;
      font-family: League Gothic;
      color: #FFF;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: #000 5px 5px 0,
        #000 0px 5px 0,
        #000 -5px 5px 0,
        #000 -5px 0px 0,
        #000 -5px -5px 0,
        #000 0px -5px 0,
        #000 5px -5px 0,
        #000 5px 0px 0,
        #000 0px 0px 5px;
      overflow: hidden;
    }
    #container {
      position: absolute;
      display: flex;
      align-items: center;
      justify-content: center;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
    }
    #loading {
      font-size: 100px;
    }
    .loaded #loading {
      display: none;
    }
    #thing {
      position: relative;
    }
    #caption, #attribution {
      position: absolute;
    }
    #attribution {
      bottom: 5px;
      right: 5px;
    }
    #caption a, #attribution a {
      /* The only CSS reset I care about. */
      color: #FFF;
      text-decoration: none;
    }
    #attribution a {
      font-size: 10px;
      text-shadow: #000 2px 2px 0,
        #000 0px 2px 0,
        #000 -2px 2px 0,
        #000 -2px 0px 0,
        #000 -2px -2px 0,
        #000 0px -2px 0,
        #000 2px -2px 0,
        #000 2px 0px 0,
        #000 0px 0px 2px;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="loading">Loading ...</div>
    <div id="thing">
      <div id="caption"></div>
      <div id="attribution"></div>
    </div>
  </div>

  <script type="text/javascript">
    var THINGS = [
      {image: '1.jpg', caption: 'Trash Panda', position: [50, 430], background: '#6a5544', attribution: 'https://www.flickr.com/photos/tambako/3576301909'},
      {image: '2.jpg', caption: 'Danger Noodle', position: [130, 60], background: '#b69479', attribution: 'https://commons.wikimedia.org/wiki/File:Big_Sur_Snake.JPG'},
      {image: '3.jpg', caption: 'Nope Rope', position: [80, 330], attribution: 'https://www.flickr.com/photos/aspexdesign/7497277648'},
      {image: '4.jpg', caption: 'Wizard Cow', position: [70, 150], background: '#d5e5f4', attribution: 'https://commons.wikimedia.org/wiki/File:Mountain_Goat_Mount_Massive.JPG'},
      {image: '5.jpg', caption: 'American Murder Log', position: [30, 70], size: 100, background: '#d0c2b1', attribution: 'https://commons.wikimedia.org/wiki/File:Two_american_alligators.jpg'},
      {image: '6.jpg', caption: 'Murder Log', position: [90, 60], background: '#928b84', attribution: 'https://commons.wikimedia.org/wiki/File:SaltwaterCrocodile(\'Maximo\').jpg'},
      {image: '7.jpg', caption: 'Fart Squirrel', position: [490, 280], background: '#007907', attribution: 'https://www.flickr.com/photos/payayita/3255905969/'},
      {image: '8.jpg', caption: 'Majestic Sea Flap Flap', position: [740, 230], background: '#0096cf', attribution: 'https://commons.wikimedia.org/wiki/File:Manta_Ray,_Lisboa_aquarium_2008.jpg'},
      {image: '9.jpg', caption: 'Danger Chicken', position: [510, 60], background: '#bff6bb', attribution: 'https://commons.wikimedia.org/wiki/File:Southern_Cassowary_7071.jpg'},
      {image: '10.jpg', caption: 'Beach Chicken', position: [120, 40], background: '#6888a0', attribution: 'https://commons.wikimedia.org/wiki/File:Seagull_-_Larus_dominicanus_vetula_-_(Kelp_Gull).jpg'},
      {image: '11.jpg', caption: 'Booplesnoot', position: [50, 660], background: '#a9b1bc', attribution: 'https://commons.wikimedia.org/wiki/File:Serious_bunny_(5767442711).jpg'},
      {image: '12.jpg', caption: 'Velocirabbit', position: [100, 400], background: '#9baa6e', attribution: 'https://www.flickr.com/photos/timmythesuk/403782624'},
      {image: '13.jpg', caption: 'Hot Moose', position: [70, 280], background: '#e2c79d', attribution: 'https://commons.wikimedia.org/wiki/File:Camels_at_Camel_Research_Farm,_Bikaner.jpg'},
      {image: '14.jpg', caption: 'Thunder Chicken', position: [80, 260], size: 90, background: '#b5a282', attribution: 'https://commons.wikimedia.org/wiki/File:Ostrich_Struthio_camelus_Tanzania_3739_cropped_Nevit.jpg'},
      {image: '15.jpg', caption: 'Danger Zebra', position: [700, 570], background: '#32632b', attribution: 'https://commons.wikimedia.org/wiki/File:White_Tiger_6_(3865790598).jpg'},
      {image: '16.jpg', caption: 'Loud Nope Rope', position: [120, 120], background: '#d0c0ac', attribution: 'https://commons.wikimedia.org/wiki/File:Timber_Rattlesnake_(dark_coloration).JPG'},
      {image: '17.jpg', caption: 'Furry Potato', position: [30, 90], attribution: 'https://www.flickr.com/photos/45383134@N00/3268972226'},
      {image: '18.jpg', caption: 'Floaty Potato', position: [10, 650], background: '#008dd3', attribution: 'https://commons.wikimedia.org/wiki/File:Manatee_at_Sea_World_Orlando_Mar_10.JPG'},
      {image: '19.jpg', caption: 'Dragon Mouse', position: [530, 110], background: '#afaba0', attribution: 'https://commons.wikimedia.org/wiki/File:Tree_Pangolin.JPG'},
      {image: '20.jpg', caption: 'Prarie Cloud', position: [480, 440], background: '#839c29', attribution: 'https://www.flickr.com/photos/magicattic88/16653964914'},
      {image: '21.jpg', caption: 'Beach Roomba', position: [50, 530], background: '#9c927c', attribution: 'https://commons.wikimedia.org/wiki/File:Horseshoe_crab_in_sand.jpg'},
      // {image: '.jpg', caption: '', position: [0, 0], attribution: ''},
    ];
    var CURRENT_THING = null;

    document.addEventListener('DOMContentLoaded', function () {
      // Get persistent references to some elements.
      var containerElm = document.getElementById('container');
      var thingElm = document.getElementById('thing');
      var captionElm = document.getElementById('caption');
      var attributionElm = document.getElementById('attribution');

      // Helper methods.
      var scaleThing = function(elm) {
        elm = elm || document.getElementById('picture');
        if(elm) {
          var xScale = document.documentElement.clientWidth / elm.width;
          var yScale = document.documentElement.clientHeight / elm.height;
          var xyScale = Math.min(xScale, yScale);
          thingElm.style.transform = 'scale('+xyScale+','+xyScale+')';
        }
      };

      var getThing = function(checkHash, notRandomId, thingId) {
        // Get a thing to use.
        var thing = null;
        if(thingId) {
          thing = THINGS[parseInt(thingId, 10) - 1];
          thing.label = thingId;
        }
        if(!thing && checkHash && window.location.hash && window.location.hash != '#') {
          // Use the hash to load a specific thing.
          var id = parseInt(window.location.hash.substr(1), 10);
          if(0 < id && id <= THINGS.length) {
            thing = THINGS[id - 1]
            thing.label = id;
          }
        }
        if(!thing) {
          // Get a random thing as a fallback.
          var id;
          do {
            id = Math.floor(Math.random() * THINGS.length);
          } while(notRandomId && id+1 == notRandomId);
          thing = THINGS[id];
          thing.label = id + 1;
        }
        // Fill in default values.
        thing.size = thing.size || 140;
        thing.background = thing.background || '#000';
        return thing;
      };

      var loadingThing = false;
      var displayThing = function(thing) {
        // Only load one thing at a time.
        if(loadingThing) return;
        loadingThing = true;
        // Display a thing.
        var elm = document.createElement('img');
        elm.addEventListener('load', function() {
          // Hide the loading indicator if needed.
          document.body.className = 'loaded';
          // Remove any existing image.
          var oldImg = document.getElementById('picture');
          if(oldImg) oldImg.parentNode.removeChild(oldImg);
          // Display the image.
          elm.id = 'picture';
          thingElm.appendChild(elm);
          // Clear existing caption/attribution links.
          while (captionElm.hasChildNodes()) { captionElm.removeChild(captionElm.lastChild); }
          while (attributionElm.hasChildNodes()) { attributionElm.removeChild(attributionElm.lastChild); }
          // Populate and position caption/attribution.
          var captionLink = document.createElement('a');
          captionLink.innerText = thing.caption;
          captionLink.href = '#' + thing.label;
          captionLink.addEventListener('click', function(evt) {
            evt.stopPropagation();
            ga('send', 'event', 'Caption', 'click', thing.label);
            return true;
          });
          captionElm.style.top = thing.position[0] + 'px';
          captionElm.style.left = thing.position[1] + 'px';
          captionElm.style['font-size'] = thing.size + 'px';
          captionElm.appendChild(captionLink);
          var attributeLink = document.createElement('a');
          attributeLink.href = thing.attribution;
          attributeLink.innerText = thing.attribution;
          attributeLink.target = '_blank';
          attributeLink.addEventListener('click', function(evt) {
            evt.stopPropagation();
            ga('send', 'event', 'Attribution', 'click', thing.label);
            return true;
          });
          attributionElm.appendChild(attributeLink);
          // Scale the thing to match the screen.
          scaleThing(elm);
          // Change the title.
          document.title = thing.caption;
          // Set background color.
          document.body.style['background-color'] = thing.background;
          // Done loading.
          loadingThing = false;
          CURRENT_THING = thing;
          ga('set', 'page', '/'+thing.label);
          ga('send', 'pageview');
        });
        elm.src = thing.image;
      };

      // Set up some event handlers.
      window.addEventListener('resize', function() { scaleThing(); });
      window.addEventListener('hashchange', function() { displayThing(getThing(true)); });
      document.body.addEventListener('click', function() {
        if(window.location.hash && window.location.hash != '#') window.location.hash = '';
        ga('send', 'event', 'Body', 'click');
        displayThing(getThing(false, CURRENT_THING.label));
      });
      document.body.addEventListener('keydown', function(evt) {
        if(evt.keyCode && 37 <= evt.keyCode && evt.keyCode <= 40) {
          evt.stopPropagation();
          evt.preventDefault();
          if(!loadingThing && CURRENT_THING && evt.keyCode == 37) {
            // Left arrow.
            var prevId = CURRENT_THING.label - 1;
            if(prevId <= 0) prevId = THINGS.length;
            displayThing(getThing(false, null, prevId));
            window.location.hash = '#' + prevId;
            ga('send', 'event', 'Arrow Keys', 'press', 'left');
          }
          else if(!loadingThing && CURRENT_THING && evt.keyCode == 39) {
            // Right arrow.
            var nextId = CURRENT_THING.label + 1;
            if(nextId > THINGS.length) nextId = 1;
            displayThing(getThing(false, null, nextId));
            window.location.hash = '#' + nextId;
            ga('send', 'event', 'Arrow Keys', 'press', 'right');
          }
          return false;
        }
        return true;
      });

      // Do initial load.
      displayThing(getThing(true));
    });

    // Google tracking, sorry.
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-19700911-2', 'auto');
  </script>
</body>
</html>

